{% extends "layout.html" %}
{% block title %}{{ summit.format_name() }} {{ summit.format_name_alt() }} {% endblock %}
{% block description %}Вершина {{ summit.format_name() }} {{ summit.format_name_alt() }} хребта {{ summit.ridge }} &mdash; расшифровка названия, высота, координаты{% endblock %}
{% block content %}
<h1>
{{ summit.format_name() }} <small>{{ summit.format_name_alt() }}
{% if current_user.admin %}
<a href="{{ url_for('summit_edit', summit_id=summit.id) }}"><span class="glyphicon glyphicon-edit"></span></a>
<a href="{{ url_for('summit_delete', summit_id=summit.id) }}" class="simple-delete-confirm"><span class="glyphicon glyphicon-remove"></span></a>
{% endif %}
</small>
</h1>
<dl class="dl-horizontal">
    <dt>Высота</dt>
    <dd>{{ summit.height }}</dd>
</dl>
<dl class="dl-horizontal">
    <dt>Хребет</dt>
    <dd>{{ summit.ridge }}</dd>
</dl>
<dl class="dl-horizontal">
    <dt>Координаты</dt>
    <dd><a href="{{ url_for('index', sid=summit.id) }}#12/{{ summit.coordinates[0] }}/{{ summit.coordinates[1] }}">{{ summit.format_coordinates() }}</a></dd>
</dl>
{% if summit.interpretation %}
<dl class="dl-horizontal">
    <dt>Расшифровка названия</dt>
    <dd>{{ summit.interpretation | safe }}</dd>
</dl>
{% endif %}
{% if summit.description %}
<dl class="dl-horizontal">
    <dt>Дополнительная информация</dt>
    <dd>{{ summit.description | safe }}</dd>
</dl>
{% endif %}
<h3>
    Восходители
    {% if not current_user.is_authenticated() %}
        <small>(<a href="{{ url_for('login_form', r=url_for('climb_new', summit_id=summit.id)) }}" data-remote="false" data-toggle="modal" data-target="#authModal">Взошли на эту вершину?</a>)</small>
    {% elif climbers | length  == 0 or current_user != climbers[0]['user'] %} 
        <small>(<a href="{{ url_for('climb_new', summit_id=summit.id) }}">Взошли на эту вершину?</a>)</small>
    {% endif %}
</h3>
{% if climbers | length == 0 %}
Никто пока не зарегистрировал восхождение на эту вершину.
{% endif %}
<ul class="media-list">
    {% for c in climbers %}
    <li class="media">
    <div class="media-left">
        <a href="{{ url_for('user', user_id=c['user'].id) }}">
        {% if c['user'].preview_id %}
        <img src="{{ url_for("image_get", image_id=c['user'].preview_id)}}" class="media-object">
        {% else %}
        <img src="/static/climber_sm.png" class="media-object">
        {% endif %}
        </a>
    </div>
    <div class="media-body">
        <h4 class="media-heading">
            <a href="{{ url_for('user', user_id=c['user'].id) }}">{{ c['user'].name }}</a> 
        </h4>
        {% if c['date'] != None %}<div class="text-muted"><i>{{ c['date'] | climb_date }}</i></div>{% endif %}
        {% if c['comment'] %}{{ c['comment'] }}{% endif %}
        {% if c['user'] == current_user %}
        <div>
        <small><a href="{{ url_for('climb_edit', summit_id=summit.id) }}">Редактировать</a></small>
        <small><a href="{{ url_for('climb_delete', summit_id=summit.id) }}" class="simple-delete-confirm">Удалить</a></small>
        </div>
        {% endif %}
    </div>
    </li>
    {% endfor %}
</ul>
{% endblock %}
